table schedule
	lineageTag: 538354af-fa1d-4fad-b42a-c248622966e0

	column date
		dataType: dateTime
		formatString: General Date
		lineageTag: 17632fb9-880e-4dce-8ef8-d5b2f11c8903
		summarizeBy: none
		sourceColumn: date

		annotation SummarizationSetBy = Automatic

	column label
		dataType: string
		lineageTag: c69f423b-6c21-4db4-b8d2-26e66b7e0827
		summarizeBy: none
		sourceColumn: label

		annotation SummarizationSetBy = Automatic

	column source
		dataType: string
		lineageTag: 47ec36a2-15dc-41ca-b963-8a1b204c3e66
		summarizeBy: none
		sourceColumn: source

		annotation SummarizationSetBy = Automatic

	partition schedule = m
		mode: import
		source =
				let
				    headers = [#"Content-type" = "application/json"],
				    result = Web.Contents("https://api-web.nhle.com/v1/schedule/2025-03-01",[Headers = headers]), //TODO: abstract the date to a parameter
				    json = Json.Document(result),
				
				    output = #table(type table [date = datetime, label = text, source = text],{
				        {DateTime.LocalNow(), "Today","custom"},
				        {DateTime.FromText(json[nextStartDate]),"Next Game","api"},
				        {DateTime.FromText(json[preSeasonStartDate]),"Pre Season Start","api"},
				        {DateTime.FromText(json[regularSeasonStartDate]),"Regular Season Start","api"},
				        {DateTime.FromText(json[regularSeasonEndDate]),"Playoff Start Date","api"},
				        {DateTime.FromText(json[playoffEndDate]),"Playoff End Date","api"}
				    })
				in
				    output

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

